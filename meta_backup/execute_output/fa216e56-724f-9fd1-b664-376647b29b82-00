{
  "uuid" : "fa216e56-724f-9fd1-b664-376647b29b82-00",
  "last_modified" : 1584410248350,
  "version" : "3.0.0.20500",
  "content" : "Create and distribute table, cmd: \nhive -e \"set mapred.job.name='Create Intermediate Flat Hive Table';\nUSE default;\n\nDROP TABLE IF EXISTS kylin_intermediate_test_cube_e2f63bb9_a7d4_f3e8_6949_7c8c141ca38d;\nCREATE EXTERNAL TABLE IF NOT EXISTS kylin_intermediate_test_cube_e2f63bb9_a7d4_f3e8_6949_7c8c141ca38d\n(\n\\`KDN_PRODUCTS_30_DAYS_RETAILER_ID\\` bigint\n,\\`KDN_PRODUCTS_30_DAYS_BARCODE\\` string\n,\\`KDN_PRODUCTS_30_DAYS_QUANTITY\\` decimal(18,5)\n,\\`KDN_PRODUCTS_30_DAYS_REVENUE\\` decimal(18,5)\n,\\`KDN_PRODUCT_SUGGESTION_ITEM_BASED_ITEM\\` string\n,\\`KDN_PRODUCT_SUGGESTION_ITEM_BASED_RECOMMENDED_ITEM\\` string\n,\\`KDN_PRODUCT_SUGGESTION_ITEM_BASED_COUNT_COMMON_USERS\\` bigint\n,\\`KDN_PRODUCT_SUGGESTION_ITEM_BASED_EXPECTED_COMMON_USERS\\` decimal(18,5)\n,\\`KDN_PRODUCT_SUGGESTION_ITEM_BASED_SCORE\\` decimal(18,5)\n,\\`KDN_TMP_PRODUCTS_BARCODE\\` string\n,\\`KDN_TMP_PRODUCTS_NAME\\` string\n,\\`KDN_PRODUCTS_RETAILER_ID\\` bigint\n,\\`KDN_PRODUCTS_BARCODE\\` string\n,\\`KDN_PRODUCTS_QUANTITY\\` decimal(18,5)\n,\\`KDN_PRODUCTS_REVENUE\\` decimal(18,5)\n)\nSTORED AS SEQUENCEFILE\nLOCATION 'hdfs://localhost:9000/kylin/kylin_metadata/kylin-fa216e56-724f-9fd1-b664-376647b29b82/kylin_intermediate_test_cube_e2f63bb9_a7d4_f3e8_6949_7c8c141ca38d';\nALTER TABLE kylin_intermediate_test_cube_e2f63bb9_a7d4_f3e8_6949_7c8c141ca38d SET TBLPROPERTIES('auto.purge'='true');\nINSERT OVERWRITE TABLE \\`kylin_intermediate_test_cube_e2f63bb9_a7d4_f3e8_6949_7c8c141ca38d\\` SELECT\n\\`KDN_PRODUCTS_30_DAYS\\`.\\`RETAILER_ID\\` as \\`KDN_PRODUCTS_30_DAYS_RETAILER_ID\\`\n,\\`KDN_PRODUCTS_30_DAYS\\`.\\`BARCODE\\` as \\`KDN_PRODUCTS_30_DAYS_BARCODE\\`\n,\\`KDN_PRODUCTS_30_DAYS\\`.\\`QUANTITY\\` as \\`KDN_PRODUCTS_30_DAYS_QUANTITY\\`\n,\\`KDN_PRODUCTS_30_DAYS\\`.\\`REVENUE\\` as \\`KDN_PRODUCTS_30_DAYS_REVENUE\\`\n,\\`KDN_PRODUCT_SUGGESTION_ITEM_BASED\\`.\\`ITEM\\` as \\`KDN_PRODUCT_SUGGESTION_ITEM_BASED_ITEM\\`\n,\\`KDN_PRODUCT_SUGGESTION_ITEM_BASED\\`.\\`RECOMMENDED_ITEM\\` as \\`KDN_PRODUCT_SUGGESTION_ITEM_BASED_RECOMMENDED_ITEM\\`\n,\\`KDN_PRODUCT_SUGGESTION_ITEM_BASED\\`.\\`COUNT_COMMON_USERS\\` as \\`KDN_PRODUCT_SUGGESTION_ITEM_BASED_COUNT_COMMON_USERS\\`\n,\\`KDN_PRODUCT_SUGGESTION_ITEM_BASED\\`.\\`EXPECTED_COMMON_USERS\\` as \\`KDN_PRODUCT_SUGGESTION_ITEM_BASED_EXPECTED_COMMON_USERS\\`\n,\\`KDN_PRODUCT_SUGGESTION_ITEM_BASED\\`.\\`SCORE\\` as \\`KDN_PRODUCT_SUGGESTION_ITEM_BASED_SCORE\\`\n,\\`KDN_TMP_PRODUCTS\\`.\\`BARCODE\\` as \\`KDN_TMP_PRODUCTS_BARCODE\\`\n,\\`KDN_TMP_PRODUCTS\\`.\\`NAME\\` as \\`KDN_TMP_PRODUCTS_NAME\\`\n,\\`KDN_PRODUCTS\\`.\\`RETAILER_ID\\` as \\`KDN_PRODUCTS_RETAILER_ID\\`\n,\\`KDN_PRODUCTS\\`.\\`BARCODE\\` as \\`KDN_PRODUCTS_BARCODE\\`\n,\\`KDN_PRODUCTS\\`.\\`QUANTITY\\` as \\`KDN_PRODUCTS_QUANTITY\\`\n,\\`KDN_PRODUCTS\\`.\\`REVENUE\\` as \\`KDN_PRODUCTS_REVENUE\\`\n FROM \\`DEFAULT\\`.\\`KDN_PRODUCTS_30_DAYS\\` as \\`KDN_PRODUCTS_30_DAYS\\`\nINNER JOIN \\`DEFAULT\\`.\\`KDN_PRODUCT_SUGGESTION_ITEM_BASED\\` as \\`KDN_PRODUCT_SUGGESTION_ITEM_BASED\\`\nON \\`KDN_PRODUCTS_30_DAYS\\`.\\`BARCODE\\` = \\`KDN_PRODUCT_SUGGESTION_ITEM_BASED\\`.\\`ITEM\\`\nINNER JOIN \\`DEFAULT\\`.\\`KDN_TMP_PRODUCTS\\` as \\`KDN_TMP_PRODUCTS\\`\nON \\`KDN_PRODUCTS_30_DAYS\\`.\\`BARCODE\\` = \\`KDN_TMP_PRODUCTS\\`.\\`BARCODE\\`\nINNER JOIN \\`DEFAULT\\`.\\`KDN_PRODUCTS\\` as \\`KDN_PRODUCTS\\`\nON \\`KDN_PRODUCT_SUGGESTION_ITEM_BASED\\`.\\`RECOMMENDED_ITEM\\` = \\`KDN_PRODUCTS\\`.\\`BARCODE\\`\nWHERE 1=1;\n\n\" --hiveconf hive.merge.mapredfiles=false --hiveconf hive.auto.convert.join=true --hiveconf dfs.replication=2 --hiveconf hive.exec.compress.output=true --hiveconf hive.auto.convert.join.noconditionaltask=true --hiveconf mapreduce.job.split.metainfo.maxsize=-1 --hiveconf hive.merge.mapfiles=false --hiveconf hive.auto.convert.join.noconditionaltask.size=100000000 --hiveconf hive.stats.autogather=true\nls: cannot access /home/admin/spark-2.3.1-bin-hadoop2.6/lib/spark-assembly-*.jar: No such file or directory\n\nLogging initialized using configuration in jar:file:/home/admin/apache-hive-1.2.1-bin/lib/hive-common-1.2.1.jar!/hive-log4j.properties\nOK\nTime taken: 0.957 seconds\nOK\nTime taken: 0.053 seconds\nOK\nTime taken: 0.337 seconds\nOK\nTime taken: 0.125 seconds\nQuery ID = root_20200317015706_ccaa276e-108f-4949-af38-322c31670745\nTotal jobs = 1\nExecution log at: /tmp/root/root_20200317015706_ccaa276e-108f-4949-af38-322c31670745.log\n2020-03-17 01:57:11\tStarting to launch local task to process map join;\tmaximum memory = 477626368\n2020-03-17 01:57:13\tDump the side-table for tag: 1 with group count: 1 into file: file:/tmp/root/17c64e3b-38f5-4e9f-ba81-23a0ef0d61a7/hive_2020-03-17_01-57-06_951_1251059369111623884-1/-local-10003/HashTable-Stage-7/MapJoin-mapfile01--.hashtable\n2020-03-17 01:57:13\tUploaded 1 File to: file:/tmp/root/17c64e3b-38f5-4e9f-ba81-23a0ef0d61a7/hive_2020-03-17_01-57-06_951_1251059369111623884-1/-local-10003/HashTable-Stage-7/MapJoin-mapfile01--.hashtable (286 bytes)\n2020-03-17 01:57:13\tDump the side-table for tag: 0 with group count: 1 into file: file:/tmp/root/17c64e3b-38f5-4e9f-ba81-23a0ef0d61a7/hive_2020-03-17_01-57-06_951_1251059369111623884-1/-local-10003/HashTable-Stage-7/MapJoin-mapfile10--.hashtable\n2020-03-17 01:57:13\tUploaded 1 File to: file:/tmp/root/17c64e3b-38f5-4e9f-ba81-23a0ef0d61a7/hive_2020-03-17_01-57-06_951_1251059369111623884-1/-local-10003/HashTable-Stage-7/MapJoin-mapfile10--.hashtable (286 bytes)\n2020-03-17 01:57:13\tDump the side-table for tag: 2 with group count: 3 into file: file:/tmp/root/17c64e3b-38f5-4e9f-ba81-23a0ef0d61a7/hive_2020-03-17_01-57-06_951_1251059369111623884-1/-local-10003/HashTable-Stage-7/MapJoin-mapfile12--.hashtable\n2020-03-17 01:57:13\tUploaded 1 File to: file:/tmp/root/17c64e3b-38f5-4e9f-ba81-23a0ef0d61a7/hive_2020-03-17_01-57-06_951_1251059369111623884-1/-local-10003/HashTable-Stage-7/MapJoin-mapfile12--.hashtable (531 bytes)\n2020-03-17 01:57:13\tEnd of local task; Time Taken: 1.095 sec.\nExecution completed successfully\nMapredLocal task succeeded\nLaunching Job 1 out of 1\nNumber of reduce tasks is set to 0 since there's no reduce operator\nStarting Job = job_1584339967426_0158, Tracking URL = http://ip-172-31-15-241.ap-east-1.compute.internal:8088/proxy/application_1584339967426_0158/\nKill Command = /home/admin/hadoop-2.7.0/bin/hadoop job  -kill job_1584339967426_0158\nHadoop job information for Stage-7: number of mappers: 1; number of reducers: 0\n2020-03-17 01:57:21,346 Stage-7 map = 0%,  reduce = 0%\n2020-03-17 01:57:26,590 Stage-7 map = 100%,  reduce = 0%, Cumulative CPU 3.43 sec\nMapReduce Total cumulative CPU time: 3 seconds 430 msec\nEnded Job = job_1584339967426_0158\nLoading data to table default.kylin_intermediate_test_cube_e2f63bb9_a7d4_f3e8_6949_7c8c141ca38d\nTable default.kylin_intermediate_test_cube_e2f63bb9_a7d4_f3e8_6949_7c8c141ca38d stats: [numFiles=0, numRows=0, totalSize=0, rawDataSize=0]\nMapReduce Jobs Launched: \nStage-Stage-7: Map: 1   Cumulative CPU: 3.43 sec   HDFS Read: 131578 HDFS Write: 231 SUCCESS\nTotal MapReduce CPU Time Spent: 3 seconds 430 msec\nOK\nTime taken: 21.0 seconds\n",
  "status" : "SUCCEED",
  "info" : {
    "startTime" : "1584410219419",
    "yarn_application_tracking_url" : "http://ip-172-31-15-241.ap-east-1.compute.internal:8088/proxy/application_1584339967426_0158/",
    "hdfs_bytes_written" : "130",
    "endTime" : "1584410248348"
  }
}