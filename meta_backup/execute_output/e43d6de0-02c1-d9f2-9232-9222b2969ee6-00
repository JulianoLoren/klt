{
  "uuid" : "e43d6de0-02c1-d9f2-9232-9222b2969ee6-00",
  "last_modified" : 1585192409043,
  "version" : "3.0.0.20500",
  "content" : "Create and distribute table, cmd: \nhive -e \"set mapred.job.name='Create Intermediate Flat Hive Table';\nUSE default;\n\nDROP TABLE IF EXISTS kylin_intermediate_api_get_relevant_categories_d10590f4_2968_6c8f_5ddc_964bea4001f0;\nCREATE EXTERNAL TABLE IF NOT EXISTS kylin_intermediate_api_get_relevant_categories_d10590f4_2968_6c8f_5ddc_964bea4001f0\n(\n\\`API_GET_RELEVANT_CATEGORIES_RETAILER_ID\\` bigint\n,\\`API_GET_RELEVANT_CATEGORIES_RECOMMENDED_ITEM\\` bigint\n,\\`API_GET_RELEVANT_CATEGORIES_AVG_QUANTITY\\` decimal(22,9)\n,\\`API_GET_RELEVANT_CATEGORIES_AVG_REVENUE\\` decimal(22,9)\n,\\`API_GET_RELEVANT_CATEGORIES_COUNT_COMMON_USERS\\` bigint\n,\\`API_GET_RELEVANT_CATEGORIES_EXPECTED_COMMON_USERS\\` decimal(18,5)\n,\\`API_GET_RELEVANT_CATEGORIES_SCORE\\` decimal(18,5)\n)\nSTORED AS SEQUENCEFILE\nLOCATION 'hdfs://localhost:9000/kylin/kylin_metadata/kylin-e43d6de0-02c1-d9f2-9232-9222b2969ee6/kylin_intermediate_api_get_relevant_categories_d10590f4_2968_6c8f_5ddc_964bea4001f0';\nALTER TABLE kylin_intermediate_api_get_relevant_categories_d10590f4_2968_6c8f_5ddc_964bea4001f0 SET TBLPROPERTIES('auto.purge'='true');\nINSERT OVERWRITE TABLE \\`kylin_intermediate_api_get_relevant_categories_d10590f4_2968_6c8f_5ddc_964bea4001f0\\` SELECT\n\\`API_GET_RELEVANT_CATEGORIES\\`.\\`RETAILER_ID\\` as \\`API_GET_RELEVANT_CATEGORIES_RETAILER_ID\\`\n,\\`API_GET_RELEVANT_CATEGORIES\\`.\\`RECOMMENDED_ITEM\\` as \\`API_GET_RELEVANT_CATEGORIES_RECOMMENDED_ITEM\\`\n,\\`API_GET_RELEVANT_CATEGORIES\\`.\\`AVG_QUANTITY\\` as \\`API_GET_RELEVANT_CATEGORIES_AVG_QUANTITY\\`\n,\\`API_GET_RELEVANT_CATEGORIES\\`.\\`AVG_REVENUE\\` as \\`API_GET_RELEVANT_CATEGORIES_AVG_REVENUE\\`\n,\\`API_GET_RELEVANT_CATEGORIES\\`.\\`COUNT_COMMON_USERS\\` as \\`API_GET_RELEVANT_CATEGORIES_COUNT_COMMON_USERS\\`\n,\\`API_GET_RELEVANT_CATEGORIES\\`.\\`EXPECTED_COMMON_USERS\\` as \\`API_GET_RELEVANT_CATEGORIES_EXPECTED_COMMON_USERS\\`\n,\\`API_GET_RELEVANT_CATEGORIES\\`.\\`SCORE\\` as \\`API_GET_RELEVANT_CATEGORIES_SCORE\\`\n FROM \\`DEFAULT\\`.\\`API_GET_RELEVANT_CATEGORIES\\` as \\`API_GET_RELEVANT_CATEGORIES\\`\nWHERE 1=1;\n\n\" --hiveconf hive.merge.mapredfiles=false --hiveconf hive.auto.convert.join=true --hiveconf dfs.replication=2 --hiveconf hive.exec.compress.output=true --hiveconf hive.auto.convert.join.noconditionaltask=true --hiveconf mapreduce.job.split.metainfo.maxsize=-1 --hiveconf hive.merge.mapfiles=false --hiveconf hive.auto.convert.join.noconditionaltask.size=100000000 --hiveconf hive.stats.autogather=true\nls: cannot access /home/admin/spark-2.3.1-bin-hadoop2.6/lib/spark-assembly-*.jar: No such file or directory\n\nLogging initialized using configuration in jar:file:/home/admin/apache-hive-1.2.1-bin/lib/hive-common-1.2.1.jar!/hive-log4j.properties\nOK\nTime taken: 1.221 seconds\nOK\nTime taken: 0.069 seconds\nOK\nTime taken: 0.426 seconds\nOK\nTime taken: 0.14 seconds\nQuery ID = root_20200326030309_28aa74f3-91d9-4aab-9740-bd8f17a0e0bc\nTotal jobs = 7\nLaunching Job 1 out of 7\nNumber of reduce tasks not specified. Estimated from input data size: 1\nIn order to change the average load for a reducer (in bytes):\n  set hive.exec.reducers.bytes.per.reducer=<number>\nIn order to limit the maximum number of reducers:\n  set hive.exec.reducers.max=<number>\nIn order to set a constant number of reducers:\n  set mapreduce.job.reduces=<number>\nStarting Job = job_1584339967426_2956, Tracking URL = http://ip-172-31-15-241.ap-east-1.compute.internal:8088/proxy/application_1584339967426_2956/\nKill Command = /home/admin/hadoop-2.7.0/bin/hadoop job  -kill job_1584339967426_2956\nHadoop job information for Stage-1: number of mappers: 1; number of reducers: 1\n2020-03-26 03:05:17,305 Stage-1 map = 0%,  reduce = 0%\n2020-03-26 03:05:23,742 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 4.37 sec\n2020-03-26 03:05:29,957 Stage-1 map = 100%,  reduce = 100%, Cumulative CPU 6.16 sec\nMapReduce Total cumulative CPU time: 6 seconds 160 msec\nEnded Job = job_1584339967426_2956\nExecution log at: /tmp/root/root_20200326030309_28aa74f3-91d9-4aab-9740-bd8f17a0e0bc.log\n2020-03-26 03:05:34\tStarting to launch local task to process map join;\tmaximum memory = 477626368\n2020-03-26 03:05:35\tDump the side-table for tag: 1 with group count: 60 into file: file:/tmp/root/15eaf216-3c5a-4774-bfbd-b8d328f52d24/hive_2020-03-26_03-03-09_566_3043129302956111668-1/-local-10010/HashTable-Stage-11/MapJoin-mapfile21--.hashtable\n2020-03-26 03:05:35\tUploaded 1 File to: file:/tmp/root/15eaf216-3c5a-4774-bfbd-b8d328f52d24/hive_2020-03-26_03-03-09_566_3043129302956111668-1/-local-10010/HashTable-Stage-11/MapJoin-mapfile21--.hashtable (64770 bytes)\n2020-03-26 03:05:35\tEnd of local task; Time Taken: 1.238 sec.\nExecution completed successfully\nMapredLocal task succeeded\nLaunching Job 2 out of 7\nNumber of reduce tasks is set to 0 since there's no reduce operator\nStarting Job = job_1584339967426_2960, Tracking URL = http://ip-172-31-15-241.ap-east-1.compute.internal:8088/proxy/application_1584339967426_2960/\nKill Command = /home/admin/hadoop-2.7.0/bin/hadoop job  -kill job_1584339967426_2960\nHadoop job information for Stage-11: number of mappers: 1; number of reducers: 0\n2020-03-26 03:07:44,588 Stage-11 map = 0%,  reduce = 0%\n2020-03-26 03:07:55,987 Stage-11 map = 100%,  reduce = 0%, Cumulative CPU 11.6 sec\nMapReduce Total cumulative CPU time: 11 seconds 600 msec\nEnded Job = job_1584339967426_2960\nStage-12 is selected by condition resolver.\nStage-13 is filtered out by condition resolver.\nStage-2 is filtered out by condition resolver.\nExecution log at: /tmp/root/root_20200326030309_28aa74f3-91d9-4aab-9740-bd8f17a0e0bc.log\n2020-03-26 03:08:01\tStarting to launch local task to process map join;\tmaximum memory = 477626368\n2020-03-26 03:08:01\tDump the side-table for tag: 1 with group count: 75 into file: file:/tmp/root/15eaf216-3c5a-4774-bfbd-b8d328f52d24/hive_2020-03-26_03-03-09_566_3043129302956111668-1/-local-10006/HashTable-Stage-8/MapJoin-mapfile01--.hashtable\n2020-03-26 03:08:01\tUploaded 1 File to: file:/tmp/root/15eaf216-3c5a-4774-bfbd-b8d328f52d24/hive_2020-03-26_03-03-09_566_3043129302956111668-1/-local-10006/HashTable-Stage-8/MapJoin-mapfile01--.hashtable (2876 bytes)\n2020-03-26 03:08:01\tEnd of local task; Time Taken: 0.729 sec.\nExecution completed successfully\nMapredLocal task succeeded\nLaunching Job 4 out of 7\nNumber of reduce tasks is set to 0 since there's no reduce operator\nStarting Job = job_1584339967426_2964, Tracking URL = http://ip-172-31-15-241.ap-east-1.compute.internal:8088/proxy/application_1584339967426_2964/\nKill Command = /home/admin/hadoop-2.7.0/bin/hadoop job  -kill job_1584339967426_2964\nHadoop job information for Stage-8: number of mappers: 1; number of reducers: 0\n2020-03-26 03:09:33,507 Stage-8 map = 0%,  reduce = 0%\n2020-03-26 03:10:04,633 Stage-8 map = 100%,  reduce = 0%, Cumulative CPU 32.41 sec\nMapReduce Total cumulative CPU time: 32 seconds 410 msec\nEnded Job = job_1584339967426_2964\nLaunching Job 5 out of 7\nNumber of reduce tasks not specified. Estimated from input data size: 1\nIn order to change the average load for a reducer (in bytes):\n  set hive.exec.reducers.bytes.per.reducer=<number>\nIn order to limit the maximum number of reducers:\n  set hive.exec.reducers.max=<number>\nIn order to set a constant number of reducers:\n  set mapreduce.job.reduces=<number>\nStarting Job = job_1584339967426_2967, Tracking URL = http://ip-172-31-15-241.ap-east-1.compute.internal:8088/proxy/application_1584339967426_2967/\nKill Command = /home/admin/hadoop-2.7.0/bin/hadoop job  -kill job_1584339967426_2967\nHadoop job information for Stage-3: number of mappers: 1; number of reducers: 1\n2020-03-26 03:11:06,397 Stage-3 map = 0%,  reduce = 0%\n2020-03-26 03:11:26,054 Stage-3 map = 48%,  reduce = 0%, Cumulative CPU 22.52 sec\n2020-03-26 03:11:31,219 Stage-3 map = 77%,  reduce = 0%, Cumulative CPU 29.74 sec\n2020-03-26 03:11:33,267 Stage-3 map = 100%,  reduce = 0%, Cumulative CPU 31.26 sec\n2020-03-26 03:11:44,613 Stage-3 map = 100%,  reduce = 79%, Cumulative CPU 42.16 sec\n2020-03-26 03:11:47,707 Stage-3 map = 100%,  reduce = 88%, Cumulative CPU 45.34 sec\n2020-03-26 03:11:50,782 Stage-3 map = 100%,  reduce = 97%, Cumulative CPU 48.36 sec\n2020-03-26 03:11:51,807 Stage-3 map = 100%,  reduce = 100%, Cumulative CPU 49.67 sec\nMapReduce Total cumulative CPU time: 49 seconds 670 msec\nEnded Job = job_1584339967426_2967\nLaunching Job 6 out of 7\nNumber of reduce tasks determined at compile time: 1\nIn order to change the average load for a reducer (in bytes):\n  set hive.exec.reducers.bytes.per.reducer=<number>\nIn order to limit the maximum number of reducers:\n  set hive.exec.reducers.max=<number>\nIn order to set a constant number of reducers:\n  set mapreduce.job.reduces=<number>\nStarting Job = job_1584339967426_2970, Tracking URL = http://ip-172-31-15-241.ap-east-1.compute.internal:8088/proxy/application_1584339967426_2970/\nKill Command = /home/admin/hadoop-2.7.0/bin/hadoop job  -kill job_1584339967426_2970\nHadoop job information for Stage-4: number of mappers: 1; number of reducers: 1\n2020-03-26 03:13:10,673 Stage-4 map = 0%,  reduce = 0%\n2020-03-26 03:13:17,965 Stage-4 map = 100%,  reduce = 0%, Cumulative CPU 5.64 sec\n2020-03-26 03:13:27,257 Stage-4 map = 100%,  reduce = 100%, Cumulative CPU 14.41 sec\nMapReduce Total cumulative CPU time: 14 seconds 410 msec\nEnded Job = job_1584339967426_2970\nLoading data to table default.kylin_intermediate_api_get_relevant_categories_d10590f4_2968_6c8f_5ddc_964bea4001f0\nTable default.kylin_intermediate_api_get_relevant_categories_d10590f4_2968_6c8f_5ddc_964bea4001f0 stats: [numFiles=0, numRows=240857, totalSize=0, rawDataSize=15154626]\nMapReduce Jobs Launched: \nStage-Stage-1: Map: 1  Reduce: 1   Cumulative CPU: 6.16 sec   HDFS Read: 1439811 HDFS Write: 2644 SUCCESS\nStage-Stage-11: Map: 1   Cumulative CPU: 11.6 sec   HDFS Read: 1438164 HDFS Write: 137709526 SUCCESS\nStage-Stage-8: Map: 1   Cumulative CPU: 32.41 sec   HDFS Read: 137716720 HDFS Write: 185856131 SUCCESS\nStage-Stage-3: Map: 1  Reduce: 1   Cumulative CPU: 49.67 sec   HDFS Read: 185864878 HDFS Write: 12235385 SUCCESS\nStage-Stage-4: Map: 1  Reduce: 1   Cumulative CPU: 14.41 sec   HDFS Read: 12243778 HDFS Write: 16750620 SUCCESS\nTotal MapReduce CPU Time Spent: 1 minutes 54 seconds 250 msec\nOK\nTime taken: 618.999 seconds\n",
  "status" : "SUCCEED",
  "info" : {
    "startTime" : "1585191779422",
    "yarn_application_tracking_url" : "http://ip-172-31-15-241.ap-east-1.compute.internal:8088/proxy/application_1584339967426_2970/",
    "hdfs_bytes_written" : "16750461",
    "endTime" : "1585192409040"
  }
}