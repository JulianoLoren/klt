{
  "uuid" : "fa28aa1d-2f68-e986-d814-c9e11fa6f984-00",
  "last_modified" : 1585017122486,
  "version" : "3.0.0.20500",
  "content" : "Create and distribute table, cmd: \nhive -e \"set mapred.job.name='Create Intermediate Flat Hive Table';\nUSE default;\n\nDROP TABLE IF EXISTS kylin_intermediate_api_get_relevant_products_586c300e_5276_cdb5_00e6_122b8b8f317c;\nCREATE EXTERNAL TABLE IF NOT EXISTS kylin_intermediate_api_get_relevant_products_586c300e_5276_cdb5_00e6_122b8b8f317c\n(\n\\`API_GET_RELEVANT_PRODUCTS_RETAILER_ID\\` bigint\n,\\`API_GET_RELEVANT_PRODUCTS_RECOMMENDED_ITEM\\` string\n,\\`API_GET_RELEVANT_PRODUCTS_RECOMMENDED_ITEM_NAME\\` string\n,\\`API_GET_RELEVANT_PRODUCTS_AVG_QUANTITY\\` decimal(22,9)\n,\\`API_GET_RELEVANT_PRODUCTS_AVG_REVENUE\\` decimal(22,9)\n,\\`API_GET_RELEVANT_PRODUCTS_COUNT_COMMON_USERS\\` bigint\n,\\`API_GET_RELEVANT_PRODUCTS_EXPECTED_COMMON_USERS\\` decimal(18,5)\n,\\`API_GET_RELEVANT_PRODUCTS_SCORE\\` decimal(18,5)\n)\nSTORED AS SEQUENCEFILE\nLOCATION 'hdfs://localhost:9000/kylin/kylin_metadata/kylin-fa28aa1d-2f68-e986-d814-c9e11fa6f984/kylin_intermediate_api_get_relevant_products_586c300e_5276_cdb5_00e6_122b8b8f317c';\nALTER TABLE kylin_intermediate_api_get_relevant_products_586c300e_5276_cdb5_00e6_122b8b8f317c SET TBLPROPERTIES('auto.purge'='true');\nINSERT OVERWRITE TABLE \\`kylin_intermediate_api_get_relevant_products_586c300e_5276_cdb5_00e6_122b8b8f317c\\` SELECT\n\\`API_GET_RELEVANT_PRODUCTS\\`.\\`RETAILER_ID\\` as \\`API_GET_RELEVANT_PRODUCTS_RETAILER_ID\\`\n,\\`API_GET_RELEVANT_PRODUCTS\\`.\\`RECOMMENDED_ITEM\\` as \\`API_GET_RELEVANT_PRODUCTS_RECOMMENDED_ITEM\\`\n,\\`API_GET_RELEVANT_PRODUCTS\\`.\\`RECOMMENDED_ITEM_NAME\\` as \\`API_GET_RELEVANT_PRODUCTS_RECOMMENDED_ITEM_NAME\\`\n,\\`API_GET_RELEVANT_PRODUCTS\\`.\\`AVG_QUANTITY\\` as \\`API_GET_RELEVANT_PRODUCTS_AVG_QUANTITY\\`\n,\\`API_GET_RELEVANT_PRODUCTS\\`.\\`AVG_REVENUE\\` as \\`API_GET_RELEVANT_PRODUCTS_AVG_REVENUE\\`\n,\\`API_GET_RELEVANT_PRODUCTS\\`.\\`COUNT_COMMON_USERS\\` as \\`API_GET_RELEVANT_PRODUCTS_COUNT_COMMON_USERS\\`\n,\\`API_GET_RELEVANT_PRODUCTS\\`.\\`EXPECTED_COMMON_USERS\\` as \\`API_GET_RELEVANT_PRODUCTS_EXPECTED_COMMON_USERS\\`\n,\\`API_GET_RELEVANT_PRODUCTS\\`.\\`SCORE\\` as \\`API_GET_RELEVANT_PRODUCTS_SCORE\\`\n FROM \\`DEFAULT\\`.\\`API_GET_RELEVANT_PRODUCTS\\` as \\`API_GET_RELEVANT_PRODUCTS\\`\nWHERE 1=1;\n\n\" --hiveconf hive.merge.mapredfiles=false --hiveconf hive.auto.convert.join=true --hiveconf dfs.replication=2 --hiveconf hive.exec.compress.output=true --hiveconf hive.auto.convert.join.noconditionaltask=true --hiveconf mapreduce.job.split.metainfo.maxsize=-1 --hiveconf hive.merge.mapfiles=false --hiveconf hive.auto.convert.join.noconditionaltask.size=100000000 --hiveconf hive.stats.autogather=true\nls: cannot access /home/admin/spark-2.3.1-bin-hadoop2.6/lib/spark-assembly-*.jar: No such file or directory\n\nLogging initialized using configuration in jar:file:/home/admin/apache-hive-1.2.1-bin/lib/hive-common-1.2.1.jar!/hive-log4j.properties\nOK\nTime taken: 0.99 seconds\nOK\nTime taken: 0.071 seconds\nOK\nTime taken: 0.357 seconds\nOK\nTime taken: 0.122 seconds\nQuery ID = root_20200324022602_61810f78-e33e-41a7-888a-66adf0b9a7e9\nTotal jobs = 7\nLaunching Job 1 out of 7\nNumber of reduce tasks not specified. Estimated from input data size: 1\nIn order to change the average load for a reducer (in bytes):\n  set hive.exec.reducers.bytes.per.reducer=<number>\nIn order to limit the maximum number of reducers:\n  set hive.exec.reducers.max=<number>\nIn order to set a constant number of reducers:\n  set mapreduce.job.reduces=<number>\nStarting Job = job_1584339967426_2309, Tracking URL = http://ip-172-31-15-241.ap-east-1.compute.internal:8088/proxy/application_1584339967426_2309/\nKill Command = /home/admin/hadoop-2.7.0/bin/hadoop job  -kill job_1584339967426_2309\nHadoop job information for Stage-1: number of mappers: 1; number of reducers: 1\n2020-03-24 02:28:13,306 Stage-1 map = 0%,  reduce = 0%\n2020-03-24 02:28:30,207 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 31.98 sec\n2020-03-24 02:28:38,474 Stage-1 map = 100%,  reduce = 100%, Cumulative CPU 40.42 sec\nMapReduce Total cumulative CPU time: 40 seconds 420 msec\nEnded Job = job_1584339967426_2309\nExecution log at: /tmp/root/root_20200324022602_61810f78-e33e-41a7-888a-66adf0b9a7e9.log\n2020-03-24 02:28:42\tStarting to launch local task to process map join;\tmaximum memory = 477626368\n2020-03-24 02:28:44\tDump the side-table for tag: 1 with group count: 136 into file: file:/tmp/root/7d381e20-622a-4ef1-be6f-a2f8cd296025/hive_2020-03-24_02-26-02_526_5266198916057115861-1/-local-10011/HashTable-Stage-13/MapJoin-mapfile31--.hashtable\n2020-03-24 02:28:44\tUploaded 1 File to: file:/tmp/root/7d381e20-622a-4ef1-be6f-a2f8cd296025/hive_2020-03-24_02-26-02_526_5266198916057115861-1/-local-10011/HashTable-Stage-13/MapJoin-mapfile31--.hashtable (56166 bytes)\n2020-03-24 02:28:44\tDump the side-table for tag: 2 with group count: 110242 into file: file:/tmp/root/7d381e20-622a-4ef1-be6f-a2f8cd296025/hive_2020-03-24_02-26-02_526_5266198916057115861-1/-local-10011/HashTable-Stage-13/MapJoin-mapfile32--.hashtable\n2020-03-24 02:28:44\tUploaded 1 File to: file:/tmp/root/7d381e20-622a-4ef1-be6f-a2f8cd296025/hive_2020-03-24_02-26-02_526_5266198916057115861-1/-local-10011/HashTable-Stage-13/MapJoin-mapfile32--.hashtable (3419167 bytes)\n2020-03-24 02:28:44\tEnd of local task; Time Taken: 2.24 sec.\nExecution completed successfully\nMapredLocal task succeeded\nLaunching Job 2 out of 7\nNumber of reduce tasks is set to 0 since there's no reduce operator\nStarting Job = job_1584339967426_2314, Tracking URL = http://ip-172-31-15-241.ap-east-1.compute.internal:8088/proxy/application_1584339967426_2314/\nKill Command = /home/admin/hadoop-2.7.0/bin/hadoop job  -kill job_1584339967426_2314\nHadoop job information for Stage-13: number of mappers: 1; number of reducers: 0\n2020-03-24 02:30:36,219 Stage-13 map = 0%,  reduce = 0%\n2020-03-24 02:30:43,562 Stage-13 map = 100%,  reduce = 0%, Cumulative CPU 7.93 sec\nMapReduce Total cumulative CPU time: 7 seconds 930 msec\nEnded Job = job_1584339967426_2314\nStage-14 is selected by condition resolver.\nStage-15 is filtered out by condition resolver.\nStage-16 is filtered out by condition resolver.\nStage-2 is filtered out by condition resolver.\nExecution log at: /tmp/root/root_20200324022602_61810f78-e33e-41a7-888a-66adf0b9a7e9.log\n2020-03-24 02:30:49\tStarting to launch local task to process map join;\tmaximum memory = 477626368\n2020-03-24 02:30:52\tProcessing rows:\t200000\tHashtable size:\t89760\tMemory usage:\t108701088\tpercentage:\t0.228\n2020-03-24 02:30:52\tDump the side-table for tag: 1 with group count: 110239 into file: file:/tmp/root/7d381e20-622a-4ef1-be6f-a2f8cd296025/hive_2020-03-24_02-26-02_526_5266198916057115861-1/-local-10005/HashTable-Stage-9/MapJoin-mapfile01--.hashtable\n2020-03-24 02:30:52\tUploaded 1 File to: file:/tmp/root/7d381e20-622a-4ef1-be6f-a2f8cd296025/hive_2020-03-24_02-26-02_526_5266198916057115861-1/-local-10005/HashTable-Stage-9/MapJoin-mapfile01--.hashtable (4540362 bytes)\n2020-03-24 02:30:52\tDump the side-table for tag: 2 with group count: 110242 into file: file:/tmp/root/7d381e20-622a-4ef1-be6f-a2f8cd296025/hive_2020-03-24_02-26-02_526_5266198916057115861-1/-local-10005/HashTable-Stage-9/MapJoin-mapfile02--.hashtable\n2020-03-24 02:30:52\tUploaded 1 File to: file:/tmp/root/7d381e20-622a-4ef1-be6f-a2f8cd296025/hive_2020-03-24_02-26-02_526_5266198916057115861-1/-local-10005/HashTable-Stage-9/MapJoin-mapfile02--.hashtable (7193044 bytes)\n2020-03-24 02:30:52\tEnd of local task; Time Taken: 3.833 sec.\nExecution completed successfully\nMapredLocal task succeeded\nLaunching Job 4 out of 7\nNumber of reduce tasks is set to 0 since there's no reduce operator\nStarting Job = job_1584339967426_2316, Tracking URL = http://ip-172-31-15-241.ap-east-1.compute.internal:8088/proxy/application_1584339967426_2316/\nKill Command = /home/admin/hadoop-2.7.0/bin/hadoop job  -kill job_1584339967426_2316\nHadoop job information for Stage-9: number of mappers: 1; number of reducers: 0\n2020-03-24 02:31:19,757 Stage-9 map = 0%,  reduce = 0%\n2020-03-24 02:31:32,292 Stage-9 map = 100%,  reduce = 0%, Cumulative CPU 15.08 sec\nMapReduce Total cumulative CPU time: 15 seconds 80 msec\nEnded Job = job_1584339967426_2316\nLaunching Job 5 out of 7\nNumber of reduce tasks not specified. Estimated from input data size: 1\nIn order to change the average load for a reducer (in bytes):\n  set hive.exec.reducers.bytes.per.reducer=<number>\nIn order to limit the maximum number of reducers:\n  set hive.exec.reducers.max=<number>\nIn order to set a constant number of reducers:\n  set mapreduce.job.reduces=<number>\nStarting Job = job_1584339967426_2317, Tracking URL = http://ip-172-31-15-241.ap-east-1.compute.internal:8088/proxy/application_1584339967426_2317/\nKill Command = /home/admin/hadoop-2.7.0/bin/hadoop job  -kill job_1584339967426_2317\nHadoop job information for Stage-3: number of mappers: 1; number of reducers: 1\n2020-03-24 02:31:43,849 Stage-3 map = 0%,  reduce = 0%\n2020-03-24 02:31:51,149 Stage-3 map = 100%,  reduce = 0%, Cumulative CPU 6.5 sec\n2020-03-24 02:32:00,473 Stage-3 map = 100%,  reduce = 100%, Cumulative CPU 14.93 sec\nMapReduce Total cumulative CPU time: 14 seconds 930 msec\nEnded Job = job_1584339967426_2317\nLoading data to table default.kylin_intermediate_api_get_relevant_products_586c300e_5276_cdb5_00e6_122b8b8f317c\nTable default.kylin_intermediate_api_get_relevant_products_586c300e_5276_cdb5_00e6_122b8b8f317c stats: [numFiles=0, numRows=92671, totalSize=0, rawDataSize=9187957]\nMapReduce Jobs Launched: \nStage-Stage-1: Map: 1  Reduce: 1   Cumulative CPU: 40.42 sec   HDFS Read: 15753898 HDFS Write: 4451539 SUCCESS\nStage-Stage-13: Map: 1   Cumulative CPU: 7.93 sec   HDFS Read: 13334749 HDFS Write: 23668042 SUCCESS\nStage-Stage-9: Map: 1   Cumulative CPU: 15.08 sec   HDFS Read: 23676560 HDFS Write: 21551826 SUCCESS\nStage-Stage-3: Map: 1  Reduce: 1   Cumulative CPU: 14.93 sec   HDFS Read: 21562053 HDFS Write: 10291495 SUCCESS\nTotal MapReduce CPU Time Spent: 1 minutes 18 seconds 360 msec\nOK\nTime taken: 359.408 seconds\n",
  "status" : "SUCCEED",
  "info" : {
    "startTime" : "1585016753129",
    "yarn_application_tracking_url" : "http://ip-172-31-15-241.ap-east-1.compute.internal:8088/proxy/application_1584339967426_2317/",
    "hdfs_bytes_written" : "10291340",
    "endTime" : "1585017122483"
  }
}