{
  "uuid" : "b5aad469-df3a-650d-ea85-b9e955998f7b-00",
  "last_modified" : 1584419171129,
  "version" : "3.0.0.20500",
  "content" : "Create and distribute table, cmd: \nhive -e \"set mapred.job.name='Create Intermediate Flat Hive Table';\nUSE default;\n\nDROP TABLE IF EXISTS kylin_intermediate_api_get_out_of_stock_product_a1023b74_3ceb_3ef4_53b6_642b6035bebf;\nCREATE EXTERNAL TABLE IF NOT EXISTS kylin_intermediate_api_get_out_of_stock_product_a1023b74_3ceb_3ef4_53b6_642b6035bebf\n(\n\\`API_GET_OUT_OF_STOCK_PRODUCT_BUSINESS_DATE\\` string\n,\\`API_GET_OUT_OF_STOCK_PRODUCT_RETAILER_ID\\` bigint\n,\\`API_GET_OUT_OF_STOCK_PRODUCT_PRODUCT_ID\\` bigint\n,\\`API_GET_OUT_OF_STOCK_PRODUCT_BARCODE\\` string\n,\\`API_GET_OUT_OF_STOCK_PRODUCT_NAME\\` string\n,\\`API_GET_OUT_OF_STOCK_PRODUCT_DAILY_SALE_30\\` decimal(18,5)\n,\\`API_GET_OUT_OF_STOCK_PRODUCT_DAILY_SALE_20\\` decimal(18,5)\n,\\`API_GET_OUT_OF_STOCK_PRODUCT_DAILY_SALE_15\\` decimal(18,5)\n,\\`API_GET_OUT_OF_STOCK_PRODUCT_DAILY_SALE_10\\` decimal(18,5)\n,\\`API_GET_OUT_OF_STOCK_PRODUCT_DAILY_SALE_5\\` decimal(18,5)\n,\\`API_GET_OUT_OF_STOCK_PRODUCT_DAILY_SALE_1\\` decimal(18,5)\n,\\`API_GET_OUT_OF_STOCK_PRODUCT_QUANTITY_30_DAYS\\` decimal(18,5)\n,\\`API_GET_OUT_OF_STOCK_PRODUCT_REVENUE_30_DAYS\\` decimal(18,5)\n,\\`API_GET_OUT_OF_STOCK_PRODUCT_ENDING_STOCKS\\` decimal(18,5)\n,\\`API_GET_OUT_OF_STOCK_PRODUCT_INVOICE_FROM\\` bigint\n,\\`API_GET_OUT_OF_STOCK_PRODUCT_PREDICT_7\\` decimal(18,5)\n)\nSTORED AS SEQUENCEFILE\nLOCATION 'hdfs://localhost:9000/kylin/kylin_metadata/kylin-b5aad469-df3a-650d-ea85-b9e955998f7b/kylin_intermediate_api_get_out_of_stock_product_a1023b74_3ceb_3ef4_53b6_642b6035bebf';\nALTER TABLE kylin_intermediate_api_get_out_of_stock_product_a1023b74_3ceb_3ef4_53b6_642b6035bebf SET TBLPROPERTIES('auto.purge'='true');\nINSERT OVERWRITE TABLE \\`kylin_intermediate_api_get_out_of_stock_product_a1023b74_3ceb_3ef4_53b6_642b6035bebf\\` SELECT\n\\`API_GET_OUT_OF_STOCK_PRODUCT\\`.\\`BUSINESS_DATE\\` as \\`API_GET_OUT_OF_STOCK_PRODUCT_BUSINESS_DATE\\`\n,\\`API_GET_OUT_OF_STOCK_PRODUCT\\`.\\`RETAILER_ID\\` as \\`API_GET_OUT_OF_STOCK_PRODUCT_RETAILER_ID\\`\n,\\`API_GET_OUT_OF_STOCK_PRODUCT\\`.\\`PRODUCT_ID\\` as \\`API_GET_OUT_OF_STOCK_PRODUCT_PRODUCT_ID\\`\n,\\`API_GET_OUT_OF_STOCK_PRODUCT\\`.\\`BARCODE\\` as \\`API_GET_OUT_OF_STOCK_PRODUCT_BARCODE\\`\n,\\`API_GET_OUT_OF_STOCK_PRODUCT\\`.\\`NAME\\` as \\`API_GET_OUT_OF_STOCK_PRODUCT_NAME\\`\n,\\`API_GET_OUT_OF_STOCK_PRODUCT\\`.\\`DAILY_SALE_30\\` as \\`API_GET_OUT_OF_STOCK_PRODUCT_DAILY_SALE_30\\`\n,\\`API_GET_OUT_OF_STOCK_PRODUCT\\`.\\`DAILY_SALE_20\\` as \\`API_GET_OUT_OF_STOCK_PRODUCT_DAILY_SALE_20\\`\n,\\`API_GET_OUT_OF_STOCK_PRODUCT\\`.\\`DAILY_SALE_15\\` as \\`API_GET_OUT_OF_STOCK_PRODUCT_DAILY_SALE_15\\`\n,\\`API_GET_OUT_OF_STOCK_PRODUCT\\`.\\`DAILY_SALE_10\\` as \\`API_GET_OUT_OF_STOCK_PRODUCT_DAILY_SALE_10\\`\n,\\`API_GET_OUT_OF_STOCK_PRODUCT\\`.\\`DAILY_SALE_5\\` as \\`API_GET_OUT_OF_STOCK_PRODUCT_DAILY_SALE_5\\`\n,\\`API_GET_OUT_OF_STOCK_PRODUCT\\`.\\`DAILY_SALE_1\\` as \\`API_GET_OUT_OF_STOCK_PRODUCT_DAILY_SALE_1\\`\n,\\`API_GET_OUT_OF_STOCK_PRODUCT\\`.\\`QUANTITY_30_DAYS\\` as \\`API_GET_OUT_OF_STOCK_PRODUCT_QUANTITY_30_DAYS\\`\n,\\`API_GET_OUT_OF_STOCK_PRODUCT\\`.\\`REVENUE_30_DAYS\\` as \\`API_GET_OUT_OF_STOCK_PRODUCT_REVENUE_30_DAYS\\`\n,\\`API_GET_OUT_OF_STOCK_PRODUCT\\`.\\`ENDING_STOCKS\\` as \\`API_GET_OUT_OF_STOCK_PRODUCT_ENDING_STOCKS\\`\n,\\`API_GET_OUT_OF_STOCK_PRODUCT\\`.\\`INVOICE_FROM\\` as \\`API_GET_OUT_OF_STOCK_PRODUCT_INVOICE_FROM\\`\n,\\`API_GET_OUT_OF_STOCK_PRODUCT\\`.\\`PREDICT_7\\` as \\`API_GET_OUT_OF_STOCK_PRODUCT_PREDICT_7\\`\n FROM \\`DEFAULT\\`.\\`API_GET_OUT_OF_STOCK_PRODUCT\\` as \\`API_GET_OUT_OF_STOCK_PRODUCT\\`\nWHERE 1=1;\n\n\" --hiveconf hive.merge.mapredfiles=false --hiveconf hive.auto.convert.join=true --hiveconf dfs.replication=2 --hiveconf hive.exec.compress.output=true --hiveconf hive.auto.convert.join.noconditionaltask=true --hiveconf mapreduce.job.split.metainfo.maxsize=-1 --hiveconf hive.merge.mapfiles=false --hiveconf hive.auto.convert.join.noconditionaltask.size=100000000 --hiveconf hive.stats.autogather=true\nls: cannot access /home/admin/spark-2.3.1-bin-hadoop2.6/lib/spark-assembly-*.jar: No such file or directory\n\nLogging initialized using configuration in jar:file:/home/admin/apache-hive-1.2.1-bin/lib/hive-common-1.2.1.jar!/hive-log4j.properties\nOK\nTime taken: 1.513 seconds\nOK\nTime taken: 0.073 seconds\nOK\nTime taken: 0.513 seconds\nOK\nTime taken: 0.237 seconds\nQuery ID = root_20200317042444_03a45afd-8787-4e2c-ace3-d22c52f16006\nTotal jobs = 1\nExecution log at: /tmp/root/root_20200317042444_03a45afd-8787-4e2c-ace3-d22c52f16006.log\n2020-03-17 04:24:51\tStarting to launch local task to process map join;\tmaximum memory = 477626368\n2020-03-17 04:24:54\tDump the side-table for tag: 1 with group count: 110242 into file: file:/tmp/root/80ab92bc-a41e-4abc-9672-0d9447f8e1b3/hive_2020-03-17_04-24-44_439_2269577316659836334-1/-local-10002/HashTable-Stage-4/MapJoin-mapfile01--.hashtable\n2020-03-17 04:24:54\tUploaded 1 File to: file:/tmp/root/80ab92bc-a41e-4abc-9672-0d9447f8e1b3/hive_2020-03-17_04-24-44_439_2269577316659836334-1/-local-10002/HashTable-Stage-4/MapJoin-mapfile01--.hashtable (7193044 bytes)\n2020-03-17 04:24:54\tEnd of local task; Time Taken: 3.565 sec.\nExecution completed successfully\nMapredLocal task succeeded\nLaunching Job 1 out of 1\nNumber of reduce tasks is set to 0 since there's no reduce operator\nStarting Job = job_1584339967426_0325, Tracking URL = http://ip-172-31-15-241.ap-east-1.compute.internal:8088/proxy/application_1584339967426_0325/\nKill Command = /home/admin/hadoop-2.7.0/bin/hadoop job  -kill job_1584339967426_0325\nHadoop job information for Stage-4: number of mappers: 1; number of reducers: 0\n2020-03-17 04:25:59,548 Stage-4 map = 0%,  reduce = 0%\n2020-03-17 04:26:09,155 Stage-4 map = 100%,  reduce = 0%, Cumulative CPU 10.83 sec\nMapReduce Total cumulative CPU time: 10 seconds 830 msec\nEnded Job = job_1584339967426_0325\nLoading data to table default.kylin_intermediate_api_get_out_of_stock_product_a1023b74_3ceb_3ef4_53b6_642b6035bebf\nTable default.kylin_intermediate_api_get_out_of_stock_product_a1023b74_3ceb_3ef4_53b6_642b6035bebf stats: [numFiles=0, numRows=114510, totalSize=0, rawDataSize=11911912]\nMapReduce Jobs Launched: \nStage-Stage-4: Map: 1   Cumulative CPU: 10.83 sec   HDFS Read: 8447547 HDFS Write: 12805195 SUCCESS\nTotal MapReduce CPU Time Spent: 10 seconds 830 msec\nOK\nTime taken: 86.289 seconds\n",
  "status" : "SUCCEED",
  "info" : {
    "startTime" : "1584419069431",
    "yarn_application_tracking_url" : "http://ip-172-31-15-241.ap-east-1.compute.internal:8088/proxy/application_1584339967426_0325/",
    "hdfs_bytes_written" : "12805035",
    "endTime" : "1584419171128"
  }
}