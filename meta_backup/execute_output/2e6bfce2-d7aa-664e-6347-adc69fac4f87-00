{
  "uuid" : "2e6bfce2-d7aa-664e-6347-adc69fac4f87-00",
  "last_modified" : 1584341755046,
  "version" : "3.0.0.20500",
  "content" : "Create and distribute table, cmd: \nhive -e \"set mapred.job.name='Create Intermediate Flat Hive Table';\nUSE default;\n\nDROP TABLE IF EXISTS kylin_intermediate_kdn_product_suggestion_sale_speed_b33e33b8_9e66_b621_385d_dfed51e36f2d;\nCREATE EXTERNAL TABLE IF NOT EXISTS kylin_intermediate_kdn_product_suggestion_sale_speed_b33e33b8_9e66_b621_385d_dfed51e36f2d\n(\n\\`KDN_PRODUCT_SUGGESTION_SALE_SPEED_BUSINESS_DATE\\` string\n,\\`KDN_PRODUCT_SUGGESTION_SALE_SPEED_RETAILER_KEY\\` string\n,\\`KDN_PRODUCT_SUGGESTION_SALE_SPEED_PRODUCT_KEY\\` string\n,\\`KDN_PRODUCT_SUGGESTION_SALE_SPEED_CODE\\` string\n,\\`KDN_PRODUCT_SUGGESTION_SALE_SPEED_DAILY_SALE_30\\` decimal(18,5)\n,\\`KDN_PRODUCT_SUGGESTION_SALE_SPEED_DAILY_SALE_20\\` decimal(18,5)\n,\\`KDN_PRODUCT_SUGGESTION_SALE_SPEED_DAILY_SALE_15\\` decimal(18,5)\n,\\`KDN_PRODUCT_SUGGESTION_SALE_SPEED_DAILY_SALE_10\\` decimal(18,5)\n,\\`KDN_PRODUCT_SUGGESTION_SALE_SPEED_DAILY_SALE_5\\` decimal(18,5)\n,\\`KDN_PRODUCT_SUGGESTION_SALE_SPEED_DAILY_SALE_1\\` decimal(18,5)\n,\\`KDN_PRODUCT_SUGGESTION_SALE_SPEED_QUANTITY_30_DAYS\\` decimal(18,5)\n,\\`KDN_PRODUCT_SUGGESTION_SALE_SPEED_REVENUE_30_DAYS\\` decimal(18,5)\n,\\`KDN_PRODUCT_SUGGESTION_SALE_SPEED_ENDING_STOCKS\\` decimal(18,5)\n,\\`KDN_PRODUCT_SUGGESTION_SALE_SPEED_INVOICE_FROM\\` bigint\n,\\`KDN_PRODUCT_SUGGESTION_SALE_SPEED_PREDICT_7\\` decimal(18,5)\n)\nSTORED AS SEQUENCEFILE\nLOCATION 'hdfs://localhost:9000/kylin/kylin_metadata/kylin-2e6bfce2-d7aa-664e-6347-adc69fac4f87/kylin_intermediate_kdn_product_suggestion_sale_speed_b33e33b8_9e66_b621_385d_dfed51e36f2d';\nALTER TABLE kylin_intermediate_kdn_product_suggestion_sale_speed_b33e33b8_9e66_b621_385d_dfed51e36f2d SET TBLPROPERTIES('auto.purge'='true');\nINSERT OVERWRITE TABLE \\`kylin_intermediate_kdn_product_suggestion_sale_speed_b33e33b8_9e66_b621_385d_dfed51e36f2d\\` SELECT\n\\`KDN_PRODUCT_SUGGESTION_SALE_SPEED\\`.\\`BUSINESS_DATE\\` as \\`KDN_PRODUCT_SUGGESTION_SALE_SPEED_BUSINESS_DATE\\`\n,\\`KDN_PRODUCT_SUGGESTION_SALE_SPEED\\`.\\`RETAILER_KEY\\` as \\`KDN_PRODUCT_SUGGESTION_SALE_SPEED_RETAILER_KEY\\`\n,\\`KDN_PRODUCT_SUGGESTION_SALE_SPEED\\`.\\`PRODUCT_KEY\\` as \\`KDN_PRODUCT_SUGGESTION_SALE_SPEED_PRODUCT_KEY\\`\n,\\`KDN_PRODUCT_SUGGESTION_SALE_SPEED\\`.\\`CODE\\` as \\`KDN_PRODUCT_SUGGESTION_SALE_SPEED_CODE\\`\n,\\`KDN_PRODUCT_SUGGESTION_SALE_SPEED\\`.\\`DAILY_SALE_30\\` as \\`KDN_PRODUCT_SUGGESTION_SALE_SPEED_DAILY_SALE_30\\`\n,\\`KDN_PRODUCT_SUGGESTION_SALE_SPEED\\`.\\`DAILY_SALE_20\\` as \\`KDN_PRODUCT_SUGGESTION_SALE_SPEED_DAILY_SALE_20\\`\n,\\`KDN_PRODUCT_SUGGESTION_SALE_SPEED\\`.\\`DAILY_SALE_15\\` as \\`KDN_PRODUCT_SUGGESTION_SALE_SPEED_DAILY_SALE_15\\`\n,\\`KDN_PRODUCT_SUGGESTION_SALE_SPEED\\`.\\`DAILY_SALE_10\\` as \\`KDN_PRODUCT_SUGGESTION_SALE_SPEED_DAILY_SALE_10\\`\n,\\`KDN_PRODUCT_SUGGESTION_SALE_SPEED\\`.\\`DAILY_SALE_5\\` as \\`KDN_PRODUCT_SUGGESTION_SALE_SPEED_DAILY_SALE_5\\`\n,\\`KDN_PRODUCT_SUGGESTION_SALE_SPEED\\`.\\`DAILY_SALE_1\\` as \\`KDN_PRODUCT_SUGGESTION_SALE_SPEED_DAILY_SALE_1\\`\n,\\`KDN_PRODUCT_SUGGESTION_SALE_SPEED\\`.\\`QUANTITY_30_DAYS\\` as \\`KDN_PRODUCT_SUGGESTION_SALE_SPEED_QUANTITY_30_DAYS\\`\n,\\`KDN_PRODUCT_SUGGESTION_SALE_SPEED\\`.\\`REVENUE_30_DAYS\\` as \\`KDN_PRODUCT_SUGGESTION_SALE_SPEED_REVENUE_30_DAYS\\`\n,\\`KDN_PRODUCT_SUGGESTION_SALE_SPEED\\`.\\`ENDING_STOCKS\\` as \\`KDN_PRODUCT_SUGGESTION_SALE_SPEED_ENDING_STOCKS\\`\n,\\`KDN_PRODUCT_SUGGESTION_SALE_SPEED\\`.\\`INVOICE_FROM\\` as \\`KDN_PRODUCT_SUGGESTION_SALE_SPEED_INVOICE_FROM\\`\n,\\`KDN_PRODUCT_SUGGESTION_SALE_SPEED\\`.\\`PREDICT_7\\` as \\`KDN_PRODUCT_SUGGESTION_SALE_SPEED_PREDICT_7\\`\n FROM \\`DEFAULT\\`.\\`KDN_PRODUCT_SUGGESTION_SALE_SPEED\\` as \\`KDN_PRODUCT_SUGGESTION_SALE_SPEED\\`\nWHERE 1=1;\n\n\" --hiveconf hive.merge.mapredfiles=false --hiveconf hive.auto.convert.join=true --hiveconf dfs.replication=2 --hiveconf hive.exec.compress.output=true --hiveconf hive.auto.convert.join.noconditionaltask=true --hiveconf mapreduce.job.split.metainfo.maxsize=-1 --hiveconf hive.merge.mapfiles=false --hiveconf hive.auto.convert.join.noconditionaltask.size=100000000 --hiveconf hive.stats.autogather=true\nls: cannot access /home/admin/spark-2.3.1-bin-hadoop2.6/lib/spark-assembly-*.jar: No such file or directory\n\nLogging initialized using configuration in jar:file:/home/admin/apache-hive-1.2.1-bin/lib/hive-common-1.2.1.jar!/hive-log4j.properties\nOK\nTime taken: 2.843 seconds\nOK\nTime taken: 0.088 seconds\nOK\nTime taken: 0.956 seconds\nOK\nTime taken: 0.419 seconds\nQuery ID = root_20200316065422_a027887d-ad90-4df6-a025-ee003501d603\nTotal jobs = 1\nLaunching Job 1 out of 1\nNumber of reduce tasks is set to 0 since there's no reduce operator\nStarting Job = job_1584339967426_0004, Tracking URL = http://ip-172-31-15-241.ap-east-1.compute.internal:8088/proxy/application_1584339967426_0004/\nKill Command = /home/admin/hadoop-2.7.0/bin/hadoop job  -kill job_1584339967426_0004\nHadoop job information for Stage-1: number of mappers: 1; number of reducers: 0\n2020-03-16 06:55:45,232 Stage-1 map = 0%,  reduce = 0%\n2020-03-16 06:55:51,472 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 5.58 sec\nMapReduce Total cumulative CPU time: 5 seconds 580 msec\nEnded Job = job_1584339967426_0004\nLoading data to table default.kylin_intermediate_kdn_product_suggestion_sale_speed_b33e33b8_9e66_b621_385d_dfed51e36f2d\nTable default.kylin_intermediate_kdn_product_suggestion_sale_speed_b33e33b8_9e66_b621_385d_dfed51e36f2d stats: [numFiles=0, numRows=103976, totalSize=0, rawDataSize=7380044]\nMapReduce Jobs Launched: \nStage-Stage-1: Map: 1   Cumulative CPU: 5.58 sec   HDFS Read: 7595436 HDFS Write: 7422857 SUCCESS\nTotal MapReduce CPU Time Spent: 5 seconds 580 msec\nOK\nTime taken: 92.109 seconds\n",
  "status" : "SUCCEED",
  "info" : {
    "startTime" : "1584341639457",
    "yarn_application_tracking_url" : "http://ip-172-31-15-241.ap-east-1.compute.internal:8088/proxy/application_1584339967426_0004/",
    "hdfs_bytes_written" : "7422693",
    "endTime" : "1584341755034"
  }
}