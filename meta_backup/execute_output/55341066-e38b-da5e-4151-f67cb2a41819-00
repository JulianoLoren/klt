{
  "uuid" : "55341066-e38b-da5e-4151-f67cb2a41819-00",
  "last_modified" : 1581654822188,
  "version" : "3.0.0.20500",
  "content" : "Create and distribute table, cmd: \nhive -e \"set mapred.job.name='Create Intermediate Flat Hive Table';\nUSE default;\n\nDROP TABLE IF EXISTS kylin_intermediate_cube_sale_clone_6ae43d0a_66c7_a8a4_9841_f5256c53d7a4;\nCREATE EXTERNAL TABLE IF NOT EXISTS kylin_intermediate_cube_sale_clone_6ae43d0a_66c7_a8a4_9841_f5256c53d7a4\n(\n\\`KDN_ORDER_DETAILS_ID\\` bigint\n,\\`KDN_ORDER_DETAILS_ORDER_ID\\` bigint\n,\\`KDN_ORDER_DETAILS_PRODUCT_ID\\` bigint\n,\\`KDN_ORDER_DETAILS_UNIT_PRICE\\` double\n,\\`KDN_ORDER_DETAILS_DELIVERY_STATUS\\` tinyint\n,\\`KDN_ORDER_DETAILS_DELIVERED_QTY\\` int\n,\\`KDN_ORDER_DETAILS_CREATED_AT\\` string\n,\\`KDN_ORDER_DETAILS_UPDATED_AT\\` string\n,\\`KDN_PRODUCTS_NAME\\` string\n,\\`KDN_ORDER_DETAILS_QTY\\` int\n)\nSTORED AS SEQUENCEFILE\nLOCATION 'hdfs://localhost:9000/kylin/kylin_metadata/kylin-55341066-e38b-da5e-4151-f67cb2a41819/kylin_intermediate_cube_sale_clone_6ae43d0a_66c7_a8a4_9841_f5256c53d7a4';\nALTER TABLE kylin_intermediate_cube_sale_clone_6ae43d0a_66c7_a8a4_9841_f5256c53d7a4 SET TBLPROPERTIES('auto.purge'='true');\nINSERT OVERWRITE TABLE \\`kylin_intermediate_cube_sale_clone_6ae43d0a_66c7_a8a4_9841_f5256c53d7a4\\` SELECT\n\\`KDN_ORDER_DETAILS\\`.\\`ID\\` as \\`KDN_ORDER_DETAILS_ID\\`\n,\\`KDN_ORDER_DETAILS\\`.\\`ORDER_ID\\` as \\`KDN_ORDER_DETAILS_ORDER_ID\\`\n,\\`KDN_ORDER_DETAILS\\`.\\`PRODUCT_ID\\` as \\`KDN_ORDER_DETAILS_PRODUCT_ID\\`\n,\\`KDN_ORDER_DETAILS\\`.\\`UNIT_PRICE\\` as \\`KDN_ORDER_DETAILS_UNIT_PRICE\\`\n,\\`KDN_ORDER_DETAILS\\`.\\`DELIVERY_STATUS\\` as \\`KDN_ORDER_DETAILS_DELIVERY_STATUS\\`\n,\\`KDN_ORDER_DETAILS\\`.\\`DELIVERED_QTY\\` as \\`KDN_ORDER_DETAILS_DELIVERED_QTY\\`\n,\\`KDN_ORDER_DETAILS\\`.\\`CREATED_AT\\` as \\`KDN_ORDER_DETAILS_CREATED_AT\\`\n,\\`KDN_ORDER_DETAILS\\`.\\`UPDATED_AT\\` as \\`KDN_ORDER_DETAILS_UPDATED_AT\\`\n,\\`KDN_PRODUCTS\\`.\\`NAME\\` as \\`KDN_PRODUCTS_NAME\\`\n,\\`KDN_ORDER_DETAILS\\`.\\`QTY\\` as \\`KDN_ORDER_DETAILS_QTY\\`\n FROM \\`DEFAULT\\`.\\`KDN_ORDER_DETAILS\\` as \\`KDN_ORDER_DETAILS\\`\nLEFT JOIN \\`DEFAULT\\`.\\`KDN_PRODUCTS\\` as \\`KDN_PRODUCTS\\`\nON \\`KDN_ORDER_DETAILS\\`.\\`PRODUCT_ID\\` = \\`KDN_PRODUCTS\\`.\\`ID\\`\nWHERE 1=1 AND (\\`KDN_ORDER_DETAILS\\`.\\`UPDATED_AT\\` >= '2019-10-01 00:00:00' AND \\`KDN_ORDER_DETAILS\\`.\\`UPDATED_AT\\` < '2020-01-01 00:00:00')\n;\n\n\" --hiveconf hive.merge.mapredfiles=false --hiveconf hive.auto.convert.join=true --hiveconf dfs.replication=2 --hiveconf hive.exec.compress.output=true --hiveconf hive.auto.convert.join.noconditionaltask=true --hiveconf mapreduce.job.split.metainfo.maxsize=-1 --hiveconf hive.merge.mapfiles=false --hiveconf hive.auto.convert.join.noconditionaltask.size=100000000 --hiveconf hive.stats.autogather=true\nls: cannot access /home/admin/spark-2.3.1-bin-hadoop2.6/lib/spark-assembly-*.jar: No such file or directory\n\nLogging initialized using configuration in jar:file:/home/admin/apache-hive-1.2.1-bin/lib/hive-common-1.2.1.jar!/hive-log4j.properties\nOK\nTime taken: 1.388 seconds\nOK\nTime taken: 0.059 seconds\nOK\nTime taken: 0.526 seconds\nOK\nTime taken: 0.229 seconds\nQuery ID = root_20200214043216_9ecd94ad-b7e6-4285-a2e5-707916a0b082\nTotal jobs = 1\nExecution log at: /tmp/root/root_20200214043216_9ecd94ad-b7e6-4285-a2e5-707916a0b082.log\n2020-02-14 04:32:22\tStarting to launch local task to process map join;\tmaximum memory = 477626368\n2020-02-14 04:32:23\tDump the side-table for tag: 1 with group count: 9999 into file: file:/tmp/root/f6ddc098-6fa6-477c-b22b-b0f8c579dcf4/hive_2020-02-14_04-32-16_432_3211338467665132136-1/-local-10002/HashTable-Stage-4/MapJoin-mapfile01--.hashtable\n2020-02-14 04:32:23\tUploaded 1 File to: file:/tmp/root/f6ddc098-6fa6-477c-b22b-b0f8c579dcf4/hive_2020-02-14_04-32-16_432_3211338467665132136-1/-local-10002/HashTable-Stage-4/MapJoin-mapfile01--.hashtable (680510 bytes)\n2020-02-14 04:32:23\tEnd of local task; Time Taken: 1.447 sec.\nExecution completed successfully\nMapredLocal task succeeded\nLaunching Job 1 out of 1\nNumber of reduce tasks is set to 0 since there's no reduce operator\nStarting Job = job_1581647538653_0039, Tracking URL = http://ip-172-31-15-241.ap-east-1.compute.internal:8088/proxy/application_1581647538653_0039/\nKill Command = /home/admin/hadoop-2.7.0/bin/hadoop job  -kill job_1581647538653_0039\nHadoop job information for Stage-4: number of mappers: 3; number of reducers: 0\n2020-02-14 04:33:14,884 Stage-4 map = 0%,  reduce = 0%\n2020-02-14 04:33:33,154 Stage-4 map = 21%,  reduce = 0%, Cumulative CPU 36.18 sec\n2020-02-14 04:33:34,191 Stage-4 map = 37%,  reduce = 0%, Cumulative CPU 42.53 sec\n2020-02-14 04:33:37,341 Stage-4 map = 67%,  reduce = 0%, Cumulative CPU 53.28 sec\n2020-02-14 04:33:39,404 Stage-4 map = 83%,  reduce = 0%, Cumulative CPU 56.59 sec\n2020-02-14 04:33:40,425 Stage-4 map = 100%,  reduce = 0%, Cumulative CPU 60.54 sec\nMapReduce Total cumulative CPU time: 1 minutes 0 seconds 540 msec\nEnded Job = job_1581647538653_0039\nLoading data to table default.kylin_intermediate_cube_sale_clone_6ae43d0a_66c7_a8a4_9841_f5256c53d7a4\nTable default.kylin_intermediate_cube_sale_clone_6ae43d0a_66c7_a8a4_9841_f5256c53d7a4 stats: [numFiles=0, numRows=841790, totalSize=0, rawDataSize=102867819]\nMapReduce Jobs Launched: \nStage-Stage-4: Map: 3   Cumulative CPU: 60.54 sec   HDFS Read: 754785932 HDFS Write: 98560774 SUCCESS\nTotal MapReduce CPU Time Spent: 1 minutes 0 seconds 540 msec\nOK\nTime taken: 85.371 seconds\n",
  "status" : "SUCCEED",
  "info" : {
    "startTime" : "1581654718136",
    "yarn_application_tracking_url" : "http://ip-172-31-15-241.ap-east-1.compute.internal:8088/proxy/application_1581647538653_0039/",
    "hdfs_bytes_written" : "98560333",
    "source_records_size" : "754785932",
    "endTime" : "1581654822187"
  }
}